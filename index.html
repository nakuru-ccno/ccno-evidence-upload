<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Evidence Upload</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, select { width: 100%; padding: 8px; margin-top: 4px; }
    button { margin-top: 15px; padding: 10px 15px; background-color: #b22222; color: white; border: none; cursor: pointer; }
    button:hover { background-color: #7f0000; }
    #result { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Evidence Upload Form</h2>
  <form id="uploadForm">
    <label for="evidenceName">Evidence Name</label>
    <input type="text" id="evidenceName" name="evidenceName" placeholder="e.g., CME on Family Planning Methods" required />

    <label for="category">Evidence Category (Folder ID)</label>
    <input type="text" id="category" name="category" placeholder="Paste folder ID here" required />

    <label for="subCounty">Sub County</label>
    <input type="text" id="subCounty" name="subCounty" placeholder="e.g., Nakuru East" required />

    <label for="files">Choose PDF files (max 3MB each, up to 10 files)</label>
    <input type="file" id="files" name="files" accept="application/pdf" multiple required />

    <button type="submit">Upload</button>
  </form>

  <div id="result"></div>

<script>
  const form = document.getElementById('uploadForm');
  const resultDiv = document.getElementById('result');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    resultDiv.textContent = '';

    const filesInput = form.elements['files'];
    const files = filesInput.files;

    if (files.length === 0) {
      alert("Please select at least one PDF file.");
      return;
    }
    if (files.length > 10) {
      alert("You can upload up to 10 files only.");
      return;
    }
    for (const f of files) {
      if (f.type !== 'application/pdf') {
        alert(`File ${f.name} is not a PDF.`);
        return;
      }
      if (f.size > 3 * 1024 * 1024) {
        alert(`File ${f.name} exceeds 3MB size limit.`);
        return;
      }
    }

    // Prepare form data
    const formData = new FormData(form);

    try {
      const response = await fetch('https://script.google.com/macros/s/AKfycbycb6MkCa9f8MNPTZyidHvZjeqP49Q48zm2q3AM8TNgd0CEdYwdc1IoMuWBigGjHoLh/exec', {
        method: 'POST',
        body: formData
      });

      const json = await response.json();

      if (json.status === "success") {
        resultDiv.style.color = 'green';
        resultDiv.textContent = `✅ Uploaded ${json.files.length} file(s) successfully!`;
        form.reset();
      } else {
        resultDiv.style.color = 'red';
        resultDiv.textContent = `❌ Upload failed: ${json.message}`;
      }

    } catch (error) {
      resultDiv.style.color = 'red';
      resultDiv.textContent = `❌ Error: ${error.message}`;
    }
  });
</script>

<!-- Start of Tawk.to Script -->
<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/689f96a3afd36319238be667/1j2nm8s6m';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
<!-- End of Tawk.to Script -->

</body>
</html>
